<!--pages/cart/cart.wxml-->
<view class="cart-container">
  <!-- 购物车商品列表 -->
  <scroll-view class="cart-scroll" scroll-y="true" wx:if="{{cartItems.length > 0}}">
    <view class="cart-header">
      <text class="cart-title">购物车 ({{totalCount}})</text>
      <text class="clear-btn" bindtap="clearCart">清空</text>
    </view>

    <view class="cart-list">
      <view class="cart-item" wx:for="{{cartItems}}" wx:key="id">
        <image 
          class="item-image" 
          src="{{item.image}}" 
          mode="aspectFill"
        ></image>
        <view class="item-info">
          <text class="item-name">{{item.name}}</text>
          <text class="item-flavor" wx:if="{{item.dishFlavor}}">{{item.dishFlavor}}</text>
          <view class="item-bottom">
            <text class="item-price">¥{{item.amount}}</text>
            <view class="quantity-controls">
              <view class="control-btn minus" bindtap="minusItem" data-item="{{item}}">
                <text class="control-icon">-</text>
              </view>
              <text class="quantity">{{item.number}}</text>
              <view class="control-btn plus" bindtap="addItem" data-item="{{item}}">
                <text class="control-icon">+</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- 空购物车状态 -->
  <view class="empty-cart" wx:if="{{cartItems.length === 0 && !loading}}">
    <image class="empty-icon" src="/static/no_order.png"></image>
    <text class="empty-text">购物车空空如也</text>
    <text class="empty-desc">快去选购美食吧~</text>
    <button class="go-shopping-btn" bindtap="goShopping">去点餐</button>
  </view>

  <!-- 加载状态 -->
  <view class="loading" wx:if="{{loading}}">
    <text>加载中...</text>
  </view>

  <!-- 底部结算栏 -->
  <view class="checkout-bar" wx:if="{{cartItems.length > 0}}">
    <view class="price-info">
      <text class="total-price">合计：{{totalAmountText}}</text>
      <text class="delivery-fee">配送费：¥3.00</text>
    </view>
    <button 
      class="checkout-btn {{totalAmount >= minDeliveryAmount ? '' : 'disabled'}}" 
      bindtap="checkout"
    >
      {{diffAmountText}}
    </button>
  </view>
</view>
